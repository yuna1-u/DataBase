-- 1.Вывести всех клиентов из страны Canada
SELECT *
FROM customer
WHERE country LIKE 'Canada';

--2. Вывести все страны клиентов
SELECT c.country
FROM customer c;

--3. Вывести количество всех заказов
SELECT COUNT(*)
FROM orders;

--4. Вывести максимальную стоимость заказа
SELECT MAX(total_amount)
FROM orders;

--5. Найти сумму всех заказов
SELECT SUM(total_amount)
FROM orders;

--6. Найти сумму всех заказов за 2014 год
SELECT SUM(total_amount) amount_2014
FROM orders
WHERE EXTRACT(YEAR FROM order_date) = 2014;

--7. Найти среднюю стоимость всех заказов
SELECT AVG(total_amount) avg_amount
FROM orders;

--8. Найти среднюю стоимость всех заказов по каждому клиенту
SELECT customer_id, AVG(total_amount)
FROM orders
GROUP BY customer_id
ORDER BY customer_id;

--9. Найти всех клиентов, которые живут в Бразилии или Испании
SELECT *
FROM customer
WHERE country
          IN ('Spain', 'Brazil');

--10. Найти все заказы между 2013ым и 2014ым годами, которые стоили меньше 100.00$

--11. Найти всех клиентов, которые в одной из стран: Испания, Италия, Германия, Франция. Отсортируйте по странам
SELECT *
FROM customer
WHERE country
          IN ('Spain', 'Italy', 'Germany', 'France')
ORDER BY country;

--12. Найти все страны клиентов, страны которых содержаться в таблице поставщиков
SELECT DISTINCT c.country
FROM customer c
WHERE c.country IN (SELECT s.country FROM supplier s);

--13. Найти всех клиентов, имена которых начинаются на ‘Jo’
SELECT *
FROM customer
WHERE first_name LIKE 'Jo%';

--14. Найти всех клиентов, имена которых заканчиваются на ‘a’ и имеют длину ровно 4 символа
SELECT *
FROM customer
WHERE first_name LIKE '___a';

--15. Найти количество клиентов по странам
SELECT country, COUNT(*)
FROM customer
GROUP BY country;

--16. Найти количество клиентов по странам. Вывести в порядке убывания
SELECT COUNT(*), country
FROM customer
GROUP BY country
ORDER BY count(*) DESC;

--17. Найти общую сумму стоимости заказов и количество заказов по каждому клиенту (customer_id). Отсортировать по сумме
SELECT SUM(total_amount), COUNT(*), customer_id
FROM orders
GROUP BY customer_id;

--18. Найти общую сумму стоимости заказов и количество заказов по каждому клиенту (customer_id), у которых общее количество заказов больше 20ти
SELECT SUM(total_amount), COUNT(*), customer_id
FROM orders
GROUP BY customer_id
HAVING COUNT(*) > 20;

--19. Найти количество городов в каждой из стран клиентов
SELECT COUNT(*), country
FROM customer
GROUP BY country;
